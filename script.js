(() => {
  const translations = {
    nl: {
      'skip-link': 'Ga naar inhoud',
      'nav-home': 'Home',
      'nav-projecten': 'Projecten',
      'nav-bio': 'Bio',
      'nav-fotografie': 'Fotografie',
      'nav-photoshop': 'Photoshop',
      'nav-film': 'Film',
      'nav-animatie': 'Animatie',
      'nav-design': 'Design',
      'nav-contact': 'Contact',
      'brand-title': 'Portfolio',
      'brand-subtitle': 'Graphic designer',
      'hero-title-name': 'Daan Vermeulen',
      'hero-title-role': 'Graphic designer',
      'hero-lead': 'Portfolio met projecten in fotografie, design, film, photoshop, animatie en coding.',
      'hero-cta-projects': 'Bekijk projecten',
      'hero-cta-contact': 'Contact',
      'bio-title': 'BIO',
      'bio-text-1': 'Ik ben Daan Vermeulen, student aan TSM Mechelen en zit in het 6e middelbaar, richting Crossmedia STEAM. Ik ben een grafisch ontwerper met ervaring in Adobe-programma\'s, Canva, Figma en Visual Studio Code. Ik werkte aan projecten in fotografie, design, film, Photoshop, animatie en coding.',
      'bio-text-2': 'Ik ben leergierig, werk goed in een team en ga constructief om met feedback. Ik wil mezelf voortdurend verbeteren; dat zie je terug in mijn werk.',
      'projecten-title': 'Projecten',
      'projecten-text-1': 'Ik heb al aan veel verschillende projecten meegewerkt, groot, klein, alleen of in groep. Deze projecten verschillen ook hard qua inhoud. Dit gaat zo breed als van fotografie tot coding en van design tot filmproductie.',
      'projecten-emphasis': 'Ik geef me altijd volledig voor elk project waaraan ik werk en stop niet voordat ik tevreden ben.',
      'fotografie-title': 'Fotografie',
      'fotografie-text-1': 'Fotografie is een van mijn passies; dit is het soort project waar ik het liefst aan werk. Ik werk met Canon-camera\'s en bewerk mijn foto\'s in Lightroom en, waar nodig, in Photoshop.',
      'fotografie-emphasis': 'Ik heb verdiepte kennis van technische aspecten zoals scherptediepte, belichting, diafragma en sluitertijd.',
      'photoshop-title': 'Photoshop',
      'photoshop-text-1': 'Voor Photoshop gebruik ik Adobe Photoshop. Hiermee kan ik eenvoudig elementen verwijderen, versterken of composities van meerdere beelden maken.',
      'photoshop-text-2': 'Voor deze projecten werk ik soms met realistische beelden en subtiele aanpassingen, maar ook met extreem surrealistische werken waarin ik mijn verbeelding de vrije loop laat.',
      'film-title': 'Film',
      'film-text-1': 'Ik werkte mee aan filmproducties, zoals kortfilms, trailers en reclamevideo\'s. Hierbij was ik betrokken bij het hele proces: van brainstorm en storyboard tot filmmomenten en soms ook acteren.',
      'film-text-2': 'Ik bewerkte de video\'s vervolgens zelf en gebruikte technieken zoals color grading, belichting, montage en audiobewerking.',
      'animatie-title': 'Animatie',
      'animatie-text-1': 'Voor animatie gebruik ik Adobe After Effects. De illustraties teken ik zelf in Illustrator en animeer ze daarna, met als einddoel zo soepel mogelijk beeld te creëren.',
      'animatie-emphasis': 'Bij deze vorm van animatie werk ik vooral met keyframes en maak ik vaak gebruik van snelle cuts.',
      'design-title': 'Design',
      'design-text-1': 'Voor designprojecten teken ik illustraties in Illustrator of maak ik opmaken in InDesign. Bij een opmaak — bijvoorbeeld voor een poster — houd ik rekening met witruimte, hiërarchie en typografie; bij illustraties werk ik met vectoren.',
      'design-text-2': 'Illustraties lever ik als vectorbestanden om ze scherp te houden. Opmaken exporteer ik bij voorkeur als PDF om de kwaliteit te behouden.',
      'footer-contact-title': 'Contact',
      'faq_q1': 'Met welke programma’s werk je vooral?',
      'faq_a1': 'Ik werk voornamelijk met programma’s uit de Adobe Creative Cloud, zoals Adobe Photoshop, Adobe Illustrator, Adobe InDesign en Adobe After Effects.\n\nDaarnaast gebruik ik ook Figma en Visual Studio Code voor webdesign en coding.\n\nAfhankelijk van het project kies ik bewust de tools die het beste passen bij het gewenste eindresultaat.',
      'faq_q2': 'Kan je zowel zelfstandig als in team werken?',
      'faq_a2': 'Ja, ik heb ervaring met zowel individuele projecten als groepsprojecten.\n\nWanneer ik zelfstandig werk, neem ik het volledige creatieve proces op mij — van concept en ontwerp tot afwerking. In teamverband werk ik gestructureerd, communiceer ik duidelijk en sta ik open voor feedback. Samen tot een sterk eindresultaat komen is voor mij altijd het doel.',
      'faq_q3': 'Hoe verloopt jouw creatieve proces bij een nieuw project?',
      'faq_a3': 'Mijn creatieve proces start met onderzoek en inspiratie. Ik analyseer het doel van het project en de doelgroep.\n\nDaarna werk ik ideeën uit via schetsen of moodboards om een duidelijke visuele richting te bepalen. Vervolgens zet ik het concept digitaal om en verfijn ik details zoals compositie, kleurgebruik, typografie en technische afwerking.\n\nIk blijf optimaliseren tot het ontwerp zowel visueel sterk als inhoudelijk doordacht is.',
      'faq_q4': 'Kan ik jou contacteren voor freelance werk of samenwerkingen?',
      'faq_a4': 'Ja, zeker. Ik sta open voor freelance opdrachten, samenwerkingen en nieuwe creatieve uitdagingen.\n\nJe kan mij eenvoudig contacteren via de contactsectie onderaan de website, via e-mail of telefoon. Ik reageer zo snel mogelijk en bespreek graag samen wat mogelijk is.',
      'vragen-button': 'Vragen',
      'vragen-modal-title': 'Vragen',
      'vragen-naam': 'Naam',
      'vragen-email': 'Email',
      'vragen-vraag': 'Vraag',
      'vragen-submit': 'Verstuur',
      'vragen-cancel': 'Annuleer',
      'vragen-modal-aria': 'Stel een vraag'
    },
    en: {
      'skip-link': 'Skip to content',
      'nav-home': 'Home',
      'nav-projecten': 'Projects',
      'nav-bio': 'Bio',
      'nav-fotografie': 'Photography',
      'nav-photoshop': 'Photoshop',
      'nav-film': 'Film',
      'nav-animatie': 'Animation',
      'nav-design': 'Design',
      'nav-contact': 'Contact',
      'brand-title': 'Portfolio',
      'brand-subtitle': 'Graphic designer',
      'hero-title-name': 'Daan Vermeulen',
      'hero-title-role': 'Graphic designer',
      'hero-lead': 'Portfolio with projects in photography, design, film, Photoshop, animation and coding.',
      'hero-cta-projects': 'View projects',
      'hero-cta-contact': 'Contact',
      'bio-title': 'BIO',
      'bio-text-1': 'I am Daan Vermeulen, a student at TSM Mechelen currently in the 6th year studying Crossmedia STEAM. I am a graphic designer experienced with Adobe programs, Canva, Figma and Visual Studio Code. I have worked on projects in photography, design, film, Photoshop, animation and coding.',
      'bio-text-2': 'I am eager to learn, work well in a team and respond constructively to feedback. I continually strive to improve myself; this is reflected in my work.',
      'projecten-title': 'Projects',
      'projecten-text-1': 'I have worked on many different projects, large and small, alone or in groups. These projects vary greatly in content. They range from photography to coding and from design to film production.',
      'projecten-emphasis': 'I always give my full effort to every project I work on and don\'t stop until I\'m satisfied.',
      'fotografie-title': 'Photography',
      'fotografie-text-1': 'Photography is one of my passions; it\'s the kind of project I love working on. I use Canon cameras and edit my photos in Lightroom and, when necessary, in Photoshop.',
      'fotografie-emphasis': 'I have in-depth knowledge of technical aspects such as depth of field, lighting, aperture and shutter speed.',
      'photoshop-title': 'Photoshop',
      'photoshop-text-1': 'For Photoshop I use Adobe Photoshop. With it I can easily remove elements, enhance them, or create compositions from multiple images.',
      'photoshop-text-2': 'For these projects I sometimes work with realistic images and subtle adjustments, but also with highly surreal works where I let my imagination run free.',
      'film-title': 'Film',
      'film-text-1': 'I contributed to film productions such as short films, trailers and commercials. I was involved in the entire process: from brainstorming and storyboarding to filming and sometimes acting.',
      'film-text-2': 'I also edited the videos myself afterwards, using techniques such as color grading, lighting, editing and audio work.',
      'animatie-title': 'Animation',
      'animatie-text-1': 'For animation I use Adobe After Effects. I draw the illustrations myself in Illustrator and then animate them, aiming to create as smooth a result as possible.',
      'animatie-emphasis': 'In this type of animation I mainly work with keyframes and often use quick cuts.',
      'design-title': 'Design',
      'design-text-1': 'For design projects I draw illustrations in Illustrator or create layouts in InDesign. For layouts — for example a poster — I consider whitespace, hierarchy and typography; for illustrations I work with vectors.',
      'design-text-2': 'I deliver illustrations as vector files to keep them crisp. I prefer to export layouts as PDF to preserve quality.',
      'footer-contact-title': 'Contact',
      'faq_q1': 'Which programs do you mainly work with?',
      'faq_a1': 'I mainly work with programs from the Adobe Creative Cloud, such as Adobe Photoshop, Adobe Illustrator, Adobe InDesign and Adobe After Effects.\n\nI also use Figma and Visual Studio Code for web design and coding.\n\nDepending on the project I consciously choose the tools that best fit the desired outcome.',
      'faq_q2': 'Can you work both independently and in a team?',
      'faq_a2': 'Yes, I have experience with both individual projects and group projects.\n\nWhen I work independently, I take on the entire creative process — from concept and design to finishing. In a team I work structured, communicate clearly and am open to feedback. Working together towards a strong final result is always the goal.',
      'faq_q3': 'How does your creative process go for a new project?',
      'faq_a3': 'My creative process starts with research and inspiration. I analyze the goal of the project and the target audience.\n\nThen I develop ideas through sketches or moodboards to determine a clear visual direction. I then translate the concept digitally and refine details such as composition, color use, typography and technical finishing.\n\nI keep optimizing until the design is both visually strong and conceptually sound.',
      'faq_q4': 'Can I contact you for freelance work or collaborations?',
      'faq_a4': 'Yes, certainly. I am open to freelance assignments, collaborations and new creative challenges.\n\nYou can easily contact me via the contact section at the bottom of the website, by email or phone. I will respond as soon as possible and am happy to discuss what is possible.',
      'vragen-button': 'Questions',
      'vragen-modal-title': 'Questions',
      'vragen-naam': 'Name',
      'vragen-email': 'Email',
      'vragen-vraag': 'Question',
      'vragen-submit': 'Send',
      'vragen-cancel': 'Cancel',
      'vragen-modal-aria': 'Ask a question'
    },
    fr: {
      'skip-link': 'Aller au contenu',
      'nav-home': 'Accueil',
      'nav-projecten': 'Projets',
      'nav-bio': 'Bio',
      'nav-fotografie': 'Photographie',
      'nav-photoshop': 'Photoshop',
      'nav-film': 'Film',
      'nav-animatie': 'Animation',
      'nav-design': 'Design',
      'nav-contact': 'Contact',
      'brand-title': 'Portfolio',
      'brand-subtitle': 'Concepteur graphique',
      'hero-title-name': 'Daan Vermeulen',
      'hero-title-role': 'Concepteur graphique',
      'hero-lead': 'Portfolio avec des projets en photographie, design, film, Photoshop, animation et codage.',
      'hero-cta-projects': 'Voir les projets',
      'hero-cta-contact': 'Contact',
      'bio-title': 'BIO',
      'bio-text-1': 'Je suis Daan Vermeulen, étudiant à TSM Mechelen et actuellement en 6e année dans la filière Crossmedia STEAM. Je suis designer graphique et j\'ai de l\'expérience avec les programmes Adobe, Canva, Figma et Visual Studio Code. J\'ai travaillé sur des projets en photographie, design, film, Photoshop, animation et codage.',
      'bio-text-2': 'Je suis avide d\'apprendre, je travaille bien en équipe et je traite les retours de manière constructive. Je cherche continuellement à m\'améliorer; cela se reflète dans mon travail.',
      'projecten-title': 'Projets',
      'projecten-text-1': 'J\'ai travaillé sur de nombreux projets différents, grands ou petits, seul ou en groupe. Ces projets varient beaucoup en contenu. Ils vont de la photographie au codage et du design à la production cinématographique.',
      'projecten-emphasis': 'Je donne toujours le meilleur de moi-même pour chaque projet sur lequel je travaille et je ne m\'arr\u00eate pas tant que je ne suis pas satisfait.',
      'fotografie-title': 'Photographie',
      'fotografie-text-1': 'La photographie est une de mes passions; c\'est le type de projet que j\'aime réaliser. J\'utilise des appareils Canon et j\'édite mes photos dans Lightroom et, si nécessaire, dans Photoshop.',
      'fotografie-emphasis': 'J\'ai une connaissance approfondie des aspects techniques tels que la profondeur de champ, l\'éclairage, l\'ouverture et le temps d\'exposition.',
      'photoshop-title': 'Photoshop',
      'photoshop-text-1': 'Pour Photoshop, j\'utilise Adobe Photoshop. Avec celui-ci, je peux facilement supprimer des éléments, les améliorer ou créer des compositions à partir de plusieurs images.',
      'photoshop-text-2': 'Pour ces projets, je travaille parfois avec des images réalistes et des ajustements subtils, mais aussi avec des travaux très surréalistes où je laisse libre cours à mon imagination.',
      'film-title': 'Film',
      'film-text-1': 'J\'ai participé à des productions cinématographiques telles que des courts métrages, des bandes-annonces et des publicités. J\'ai été impliqué dans l\'ensemble du processus: du brainstorming et du storyboarding au tournage et parfois au jeu d\'acteur.',
      'film-text-2': 'J\'ai également monté les vidéos moi-même par la suite, en utilisant des techniques telles que l\'étalonnage des couleurs, l\'éclairage, le montage et le traitement audio.',
      'animatie-title': 'Animation',
      'animatie-text-1': 'Pour l\'animation, j\'utilise Adobe After Effects. Je dessine les illustrations moi-même dans Illustrator, puis je les anime, en visant un rendu aussi fluide que possible.',
      'animatie-emphasis': 'Dans ce type d\'animation, je travaille principalement avec des images-clés et j\'utilise souvent des coupes rapides.',
      'design-title': 'Design',
      'design-text-1': 'Pour les projets de design, je dessine des illustrations dans Illustrator ou crée des mises en page dans InDesign. Pour les mises en page — par exemple une affiche — je prends en compte l\'espace blanc, la hiérarchie et la typographie; pour les illustrations, je travaille avec des vecteurs.',
      'design-text-2': 'Je fournis les illustrations au format vectoriel pour les garder nettes. Je préfère exporter les mises en page en PDF pour préserver la qualité.',
      'footer-contact-title': 'Contact',
      'faq_q1': 'Avec quels programmes travailles-tu principalement ?',
      'faq_a1': 'Je travaille principalement avec les programmes d\'Adobe Creative Cloud, tels qu\'Adobe Photoshop, Adobe Illustrator, Adobe InDesign et Adobe After Effects.\n\nJ\'utilise également Figma et Visual Studio Code pour la conception web et le codage.\n\nSelon le projet, je choisis consciemment les outils qui conviennent le mieux au résultat souhaité.',
      'faq_q2': 'Peux-tu travailler de manière autonome et en équipe ?',
      'faq_a2': 'Oui, j\'ai de l\'expérience avec des projets individuels et des projets de groupe.\n\nLorsque je travaille de manière autonome, je prends en charge l\'ensemble du processus créatif — du concept et du design à la finition. En équipe, je travaille de manière structurée, je communique clairement et je suis ouvert aux retours. L\'objectif est toujours d\'aboutir ensemble à un résultat final solide.',
      'faq_q3': 'Comment se déroule ton processus créatif pour un nouveau projet ?',
      'faq_a3': 'Mon processus créatif commence par la recherche et l\'inspiration. J\'analyse l\'objectif du projet et le public cible.\n\nEnsuite, je développe des idées via des croquis ou des moodboards pour déterminer une direction visuelle claire. Je transpose ensuite le concept en numérique et j\'affine les détails tels que la composition, l\'utilisation des couleurs, la typographie et la finition technique.\n\nJ\'optimise jusqu\'à ce que le design soit à la fois visuellement fort et réfléchi sur le fond.',
      'faq_q4': 'Puis-je te contacter pour du travail freelance ou des collaborations ?',
      'faq_a4': 'Oui, bien sûr. Je suis ouvert aux missions freelance, aux collaborations et aux nouveaux défis créatifs.\n\nVous pouvez me contacter facilement via la section contact en bas du site, par e-mail ou par téléphone. Je réponds dès que possible et je serai heureux de discuter de ce qui est possible.',
      'vragen-button': 'Questions',
      'vragen-modal-title': 'Questions',
      'vragen-naam': 'Nom',
      'vragen-email': 'Email',
      'vragen-vraag': 'Question',
      'vragen-submit': 'Envoyer',
      'vragen-cancel': 'Annuler',
      'vragen-modal-aria': 'Poser une question'
    }
  };

  let currentLanguage = localStorage.getItem('language') || 'nl';
  if (!localStorage.getItem('language')) {
    localStorage.setItem('language', 'nl');
  }

  const setLanguage = (lang) => {
    currentLanguage = lang;
    localStorage.setItem('language', lang);
    document.documentElement.lang = lang;
    applyTranslations();
    updateLanguageDisplay();
  };

  const updateLanguageDisplay = () => {
    const display = document.querySelector('.lang-display');
    if (display) {
      display.textContent = currentLanguage.toUpperCase();
    }
  };

  const applyTranslations = () => {
    const trans = translations[currentLanguage];
    document.documentElement.lang = currentLanguage;

    document.querySelectorAll('[data-i18n]').forEach(el => {
      const key = el.dataset.i18n;
      if (trans[key]) {
        if (el.tagName === 'LABEL') {
          el.childNodes[0].textContent = trans[key] + '\n          ';
        } else {
          el.textContent = trans[key];
        }
      }
    });

    const vragenModal = document.getElementById('vragenModal');
    if (vragenModal && trans['vragen-modal-aria']) {
      vragenModal.setAttribute('aria-label', trans['vragen-modal-aria']);
    }
  };

  const langToggleBtn = document.querySelector('.language-toggle');
  if (langToggleBtn) {
    langToggleBtn.addEventListener('click', () => {
      if (currentLanguage === 'nl') {
        setLanguage('en');
      } else if (currentLanguage === 'en') {
        setLanguage('fr');
      } else {
        setLanguage('nl');
      }
    });
  }

  updateLanguageDisplay();
  applyTranslations();

  const introOverlay = document.querySelector(".intro-overlay");
  const header = document.querySelector(".site-header");
  let introHidden = false;

  const onScrollHeader = () => {
    header?.setAttribute("data-scrolled", window.scrollY > 6 ? "true" : "false");
  };
  onScrollHeader();
  window.addEventListener("scroll", onScrollHeader, { passive: true });

  const yearElement = document.querySelector('#year');
  if (yearElement) {
    yearElement.textContent = new Date().getFullYear();
  }

  const hideIntro = () => {
    if (introHidden) return;
    introHidden = true;
    introOverlay?.classList.add("is-hidden");
  };

  if (introOverlay) {
    introOverlay.addEventListener("click", hideIntro);
    window.addEventListener("scroll", hideIntro, { passive: true });
  }

  const galleryData = {
    projecten: [
      { src: "assets/projecten/filmproductie.jpeg", title: "Filmproductie" },
      { src: "assets/projecten/foto - projecten.png", title: "Foto - projecten" },
      { src: "assets/projecten/film jean 2.png", title: "Film jean 2" },
      { src: "assets/projecten/fotogragfie - bio.jpeg", title: "Fotografie - bio" }
    ],
    fotografie: [
      { src: "assets/fotografie/amsterdam.jpeg", title: "Amsterdam" },
      { src: "assets/fotografie/big ben.jpeg", title: "Big Ben" },
      { src: "assets/fotografie/vulkaan.jpeg", title: "Vulkaan" },
      { src: "assets/fotografie/gym.jpeg", title: "Gym" },
      { src: "assets/fotografie/kampvuur.jpeg", title: "Kampvuur" },
      { src: "assets/fotografie/waterval.jpeg", title: "Waterval" },
      { src: "assets/fotografie/stad.jpeg", title: "Stad" },
      { src: "assets/fotografie/mechelen.jpeg", title: "Mechelen" },
      { src: "assets/fotografie/visser.jpeg", title: "Visser" },
      { src: "assets/fotografie/foto - fotografie.jpg", title: "Foto fotografie" },
      { src: "assets/fotografie/IMG_8166.jpeg", title: "IMG 8166" }
    ],
    photoshop: [
      { src: "assets/photoshop/foto - photoshop.jpg", title: "Foto - photoshop" },
      { src: "assets/photoshop/Surrealisme 1.jpg", title: "Surrealisme 1" },
      { src: "assets/photoshop/Surrealisme 2.jpg", title: "Surrealisme 2" },
      { src: "assets/photoshop/Surrealisme 3.jpg", title: "Surrealisme 3" },
      { src: "assets/photoshop/5CMb_VermeulenDaan_Streetwearlogo_Mockupp_Tas.jpg", title: "Streetwear logo" }
    ],
    design: [
      { src: "assets/design/foto - design.jpg", title: "Foto - design" },
      { src: "assets/design/5CMb_VermeulenDaan_Streetwearlogo_Mockupp_Tas - kopie.jpg", title: "Streetwear logo" },
      { src: "assets/design/7_5CMb_Daan_kleur IG_2 - kopie.jpg", title: "Kleur IG" },
      { src: "assets/design/Daft punk - kopie.jpg", title: "Daft punk" },
      { src: "assets/design/naamkaartje.png", title: "Naamkaartje" },
      { src: "assets/design/skyfall achterkant.png", title: "Skyfall achterkant" },
      { src: "assets/design/skyfall voorkant.png", title: "Skyfall voorkant" },
      { src: "assets/design/spiderman.jpeg", title: "Spiderman" }
    ]
  };

  const initGalleries = () => {
    document.querySelectorAll(".photo-gallery").forEach(gallery => {
      const galleryName = gallery.dataset.gallery;
      const images = galleryData[galleryName] || [];
      let current = 0;
      let autoSkipInterval = null;
      let autoSkipActive = false;

      const prevBtn = gallery.querySelector(".gallery-prev");
      const nextBtn = gallery.querySelector(".gallery-next");
      const img = gallery.querySelector(".gallery-image");

      const update = () => {
        if (img && images[current]) {
          img.style.opacity = "0";
          setTimeout(() => {
            img.src = images[current].src;
            img.style.opacity = "1";
          }, 150);
        }
      };

      const startAutoSkip = () => {
        if (autoSkipActive) return;
        autoSkipActive = true;
        autoSkipInterval = setInterval(() => {
          current = (current + 1) % images.length;
          update();
        }, 5000);
      };

      const stopAutoSkip = () => {
        autoSkipActive = false;
        if (autoSkipInterval) {
          clearInterval(autoSkipInterval);
          autoSkipInterval = null;
        }
      };

      const goNext = () => {
        current = (current + 1) % images.length;
        update();
        if (!autoSkipActive) {
          startAutoSkip();
        }
      };

      const goPrev = () => {
        current = (current - 1 + images.length) % images.length;
        update();
        if (!autoSkipActive) {
          startAutoSkip();
        }
      };

      if (prevBtn) {
        prevBtn.addEventListener("click", goPrev);
      }

      if (nextBtn) {
        nextBtn.addEventListener("click", goNext);
      }

      if (img && images[current]) {
        img.src = images[current].src;
        img.style.opacity = "1";
      }

      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (!entry.isIntersecting) {
            stopAutoSkip();
          }
        });
      }, { threshold: 0.01 });

      observer.observe(gallery);
    });
  };

  initGalleries();

  const videos = document.querySelectorAll('.media-video');
  if (videos.length) {
    const videoObserver = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        const v = entry.target;
        if (!entry.isIntersecting) {
          v.pause();
          v.currentTime = 0;
        }
      });
    }, { threshold: 0.01 });

    videos.forEach(v => videoObserver.observe(v));
  }

  const fadeElements = document.querySelectorAll('[data-fade]');
  if (fadeElements.length) {
    const fadeObserver = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('is-visible');
        }
      });
    }, { threshold: 0.1 });

    fadeElements.forEach(el => fadeObserver.observe(el));
  }

  const menuButton = document.querySelector('.menu-button');
  const menuElement = document.querySelector('.menu');
  const menuDropdown = document.querySelector('.menu-dropdown');

  if (menuButton && menuElement && menuDropdown) {
    menuButton.addEventListener('click', (e) => {
      e.preventDefault();
      menuDropdown.classList.toggle('is-open');
      menuButton.setAttribute('aria-expanded', menuDropdown.classList.contains('is-open'));
    });

    menuElement.addEventListener('mouseleave', () => {
      menuDropdown.classList.remove('is-open');
      menuButton.setAttribute('aria-expanded', 'false');
    });

    menuDropdown.querySelectorAll('a').forEach(link => {
      link.addEventListener('click', () => {
        menuDropdown.classList.remove('is-open');
        menuButton.setAttribute('aria-expanded', 'false');
      });
    });
  }

  const ownerEmail = 'vrmlndn@gmail.com';
  const vragenBtn = document.querySelector('.vragen-button');
  const vragenModal = document.getElementById('vragenModal');
  const vragenForm = document.getElementById('vragenForm');

  const openVragen = () => {
    if (!vragenModal) return;
    vragenModal.hidden = false;
    vragenModal.setAttribute('aria-hidden', 'false');
    const first = vragenModal.querySelector('input, textarea, button');
    if (first) first.focus();
  };

  const closeVragen = () => {
    if (!vragenModal) return;
    vragenModal.hidden = true;
    vragenModal.setAttribute('aria-hidden', 'true');
    if (vragenBtn) vragenBtn.focus();
  };

  if (vragenBtn && vragenModal) {
    vragenBtn.addEventListener('click', openVragen);

    vragenModal.querySelectorAll('[data-modal-close]').forEach(el => el.addEventListener('click', closeVragen));
    const closeBtn = vragenModal.querySelector('.modal-close');
    if (closeBtn) closeBtn.addEventListener('click', closeVragen);

    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && vragenModal && !vragenModal.hidden) {
        closeVragen();
      }
    });

    if (vragenForm) {
      vragenForm.addEventListener('submit', (e) => {
        e.preventDefault();
        const naam = (vragenForm.elements['naam'] && vragenForm.elements['naam'].value) || '';
        const email = (vragenForm.elements['email'] && vragenForm.elements['email'].value) || '';
        const vraag = (vragenForm.elements['vraag'] && vragenForm.elements['vraag'].value) || '';

        const subject = `Vragen van ${naam || 'website bezoeker'}`;
        const body = `Naam: ${naam}\nEmail: ${email}\n\nVraag:\n${vraag}`;
        const mailto = `mailto:${ownerEmail}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

        window.location.href = mailto;
        closeVragen();
      });
    }
  }
})();
